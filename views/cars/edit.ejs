<% layout('layouts/boilerplate') %>

<h1>Edit Car: <%= car.name %></h1>

<form action="/cars/<%= car._id %>?_method=PUT" method="POST" enctype="multipart/form-data">
    <label for="name">Name</label>
    <input type="text" name="car[name]" id="name" value="<%= car.name %>" required />

    <label for="body">Body</label>
    <input type="text" name="car[body]" id="body" value="<%= car.body %>" required />

    <label for="make">Make</label>
    <input type="text" name="car[make]" id="make" value="<%= car.make %>" required />

    <label for="model">Model</label>
    <input type="text" name="car[model]" id="model" value="<%= car.model %>" required />

    <label for="transmission">Transmission</label>
    <input type="text" name="car[transmission]" id="transmission" value="<%= car.transmission %>" required />

    <label for="fuelType">Fuel Type</label>
    <input type="text" name="car[fuelType]" id="fuelType" value="<%= car.fuelType %>" required />

    <label for="engine">Engine</label>
    <input type="text" name="car[engine]" id="engine" value="<%= car.engine %>" required />

    <label for="year">Year</label>
    <input type="number" name="car[year]" id="year" value="<%= car.year %>" required />

    <label for="mileage">Mileage</label>
    <input type="text" name="car[mileage]" id="mileage" value="<%= car.mileage %>" required />

    <label for="drive">Drive</label>
    <input type="text" name="car[drive]" id="drive" value="<%= car.drive %>" required />

    <label for="exteriorColor">Exterior Color</label>
    <input type="text" name="car[exteriorColor]" id="exteriorColor" value="<%= car.exteriorColor %>" required />

    <label for="interiorColor">Interior Color</label>
    <input type="text" name="car[interiorColor]" id="interiorColor" value="<%= car.interiorColor %>" required />

    <label for="stockId">Stock ID</label>
    <input type="text" name="car[stockId]" id="stockId" value="<%= car.stockId %>" required />

    <label for="vin">VIN</label>
    <input type="text" name="car[vin]" id="vin" value="<%= car.vin %>" required />

    <label for="price-original">Original Price</label>
    <input type="number" name="car[price][original]" id="price-original" value="<%= car.price.original %>" required />

    <label for="price-msrp">MSRP</label>
    <input type="number" name="car[price][msrp]" id="price-msrp" value="<%= car.price.msrp %>" required />

    <label for="sellerNote">Seller's Note</label>
    <textarea name="car[sellerNote]" id="sellerNote" required><%= car.sellerNote %></textarea>

    <label for="location">Location</label>
    <input type="text" name="car[location]" id="location" value="<%= car.location %>" />

    <!-- Features -->
    <label for="features-comfort">Comfort Features</label>
    <input type="text" name="car[features][comfort][]" id="features-comfort" value="<%= car.features.comfort.join(', ') %>" />

    <label for="features-entertainment">Entertainment Features</label>
    <input type="text" name="car[features][entertainment][]" id="features-entertainment" value="<%= car.features.entertainment.join(', ') %>" />

    <label for="features-safety">Safety Features</label>
    <input type="text" name="car[features][safety][]" id="features-safety" value="<%= car.features.safety.join(', ') %>" />

    <label for="features-seats">Seat Features</label>
    <input type="text" name="car[features][seats][]" id="features-seats" value="<%= car.features.seats.join(', ') %>" />

    <!-- Usage Type -->
    <label for="usageType">Usage Type</label>
    <select name="car[usageType]" id="usageType">
        <option value="None" <%= car.usageType === 'None' ? 'selected' : '' %>>None</option>
        <option value="Rental" <%= car.usageType === 'Rental' ? 'selected' : '' %>>Rental</option>
        <option value="Uber" <%= car.usageType === 'Uber' ? 'selected' : '' %>>Uber</option>
        <option value="Both" <%= car.usageType === 'Both' ? 'selected' : '' %>>Both</option>
    </select>

    <!-- Existing Images -->
    <div>
        <label for="existing-images">Existing Images</label>
        <div id="existing-images">
            <% car.images.forEach(image => { %>
                <div>
                    <img src="<%= image.url %>" alt="<%= image.filename %>" style="width: 100px; height: auto;">
                    <input type="checkbox" name="deleteImages" value="<%= image.filename %>"> Delete
                </div>
            <% }) %>
        </div>
    </div>

    <!-- New Image Upload -->
    <label for="images">Add New Images</label>
    <input type="file" name="images" id="images" multiple />

    <button type="submit">Save Changes</button>
</form>
